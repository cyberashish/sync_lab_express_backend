import{u as y,j as e,X as b,Y as g,Z as v,_ as Y,a as m,$ as R,a0 as E,B as j,M as T,a1 as B,r as x,p as H,W as P,I as _}from"./index-CK2Vs4T7.js";import{C as Q}from"./card-C9QVMAe5.js";import{u as $,i as G,T as W,a as X,b as w,c as Z,f as D,d as z,e as J,k as ee,g as se,h as ae}from"./TableSkeleton-C-Ao0mJm.js";import{T as N,a as S,b as A,c as C}from"./tooltip-BHVp_HGe.js";import{I as p}from"./iconify-tsyH9H0w.js";import{f as te}from"./format-SmSpYad1.js";import{D as q,b as M,c as k,d as L}from"./dialog-B52V-V4-.js";import"./index-qwqw3Zx2.js";import"./index-CYA3EVJn.js";import"./index-D5d6A-9p.js";const re=a=>{const s=y();return e.jsx("div",{className:"flex items-center gap-3",children:a.requestStatus==="pending"?e.jsxs(e.Fragment,{children:[e.jsx(N,{children:e.jsxs(S,{children:[e.jsx(A,{asChild:!0,children:e.jsx("button",{onClick:()=>{s(b(a)),s(g(!0))},children:e.jsx(p,{icon:"solar:check-circle-bold",width:24,height:24,className:"text-success hover:text-success/90 cursor-pointer"})})}),e.jsx(C,{children:e.jsx("p",{children:"Approve request"})})]})}),e.jsx(N,{children:e.jsxs(S,{children:[e.jsx(A,{asChild:!0,children:e.jsx("button",{onClick:()=>{s(b(a)),s(v(!0))},children:e.jsx(p,{icon:"solar:close-circle-bold",width:24,height:24,className:"text-red-500 hover:text-red-400 cursor-pointer"})})}),e.jsx(C,{className:"bg-red-500 fill-red-500",children:e.jsx("p",{children:"Disapprove Request"})})]})})]}):a.isRequestApproved?e.jsx(p,{icon:"solar:verified-check-bold",width:24,height:24,className:"text-success hover:text-success/90 cursor-pointer"}):e.jsx(p,{icon:"icon-park-twotone:close-one",width:24,height:24,className:"text-red-500 hover:text-red-500/20 cursor-pointer"})})},oe=[{accessorKey:"employeeId",header:"Id",cell:({row:a})=>e.jsx("p",{className:"text-primary",children:a.getValue("employeeId")})},{accessorKey:"name",header:"Name"},{accessorKey:"designation",header:"Position"},{accessorKey:"description",header:"Description"},{accessorKey:"date",header:({column:a})=>e.jsxs("button",{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"flex cursor-pointer group hover:text-primary items-center gap-2",children:[e.jsx("span",{children:"Applied Date"}),e.jsx(p,{icon:"mi:sort",width:20,height:20,className:"text-muted group-hover:text-primary"})]}),cell:({row:a})=>e.jsx("p",{children:Y(a.getValue("date"))}),sortingFn:(a,s)=>{const o=new Date(a.getValue("date")),l=new Date(s.getValue("date"));return o.getTime()-l.getTime()}},{accessorKey:"leaveDates",header:()=>e.jsx("button",{className:"flex cursor-pointer group hover:text-primary items-center gap-2",children:e.jsx("span",{children:"Leave Dates"})}),cell:({row:a})=>{const s=a.getValue("leaveDates");return e.jsxs("p",{className:"text-sm",children:[" ",s.map(o=>te(new Date(o.date),"do MMM")).join(", ")]})}},{accessorKey:"leave",header:"Leave"},{accessorKey:"requestStatus",header:"Status",cell:({row:a})=>{const s=a.getValue("requestStatus"),o=a.original.isRequestApproved;return s!=="pending"?o?e.jsx("span",{className:"py-0.5 px-2 text-xs bg-success/20 text-success rounded-full",children:"Approved"}):e.jsx("span",{className:"py-0.5 px-2 text-xs bg-red-500/20 text-red-500 rounded-full",children:"Rejected"}):e.jsx("span",{className:"py-0.5 px-2 text-xs bg-yellow-500/20 text-yellow-500 rounded-full",children:"Pending"})}},{id:"Approval",header:"Approval Actions",cell:({row:a})=>{const s=a.original;return re(s)}}];function le(){const a=m(i=>i.requestStatus.isDisapproveDialogOpen),s=m(i=>i.requestStatus.selectedRequest),[o]=R(),l=y(),[c,{isLoading:n}]=E(),u=async()=>{await c({id:s==null?void 0:s.id,requestStatus:"Disapproved",isRequestApproved:!1}),l(v(!1)),await o({email:s==null?void 0:s.email,title:"Leave Disapproved",message:"Your leave has been disapproved!",type:"LEAVE_REQUEST"})};return e.jsx(q,{open:a,onOpenChange:i=>l(v(i)),children:e.jsxs(M,{className:"sm:max-w-sm",children:[e.jsx(k,{children:e.jsx(L,{children:"Are you absolutely sure?"})}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsxs(j,{disabled:n,variant:"destructive",onClick:u,className:"flex items-center gap-2",children:[n?e.jsx(T,{className:"animate-spin"}):null,"DisApprove"]}),e.jsx(j,{onClick:()=>l(v(!1)),children:"Cancel"})]})]})})}function ie(){const a=m(d=>d.requestStatus.isApproveDialogOpen),s=m(d=>d.requestStatus.selectedRequest),[o,{isLoading:l}]=E(),[c]=R(),n=y(),[u]=B(),i=async()=>{await o({id:s.id,requestStatus:"Approved",isRequestApproved:!0}),await u({email:s==null?void 0:s.email,leave:s==null?void 0:s.leave,leaveType:s==null?void 0:s.leaveType}),n(g(!1)),await c({email:s==null?void 0:s.email,title:"Leave Approved",message:"Your leave has been approved!",type:"LEAVE_REQUEST"})};return e.jsx(q,{open:a,onOpenChange:d=>n(g(d)),children:e.jsxs(M,{className:"sm:max-w-sm",children:[e.jsx(k,{children:e.jsx(L,{children:"Are you absolutely sure?"})}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsxs(j,{onClick:i,disabled:l,className:"flex items-center gap-2",children:[l?e.jsx(T,{className:"animate-spin"}):null,"Approve"]}),e.jsx(j,{variant:"destructive",onClick:()=>n(g(!1)),children:"Cancel"})]})]})})}const ne={isSearchFocussed:!1,searchInput:""};function ce(){const a="SEARCH_INPUT",s="SEARCH_INPUT_FOCUSSED",o=(r,t)=>{switch(t.type){case a:return{...r,searchInput:t.payload};case s:return{...r,isSearchFocussed:t.payload};default:return r}},[l,c]=x.useReducer(o,ne),[n,u]=x.useState([]),{data:i,isLoading:d}=H(void 0),F=()=>{c({type:s,payload:!0})},I=()=>{c({type:s,payload:!1})},V=x.useMemo(()=>[...n],[n]);x.useEffect(()=>{i&&u(i.data)},[i]);const h=$({data:V,columns:oe,getCoreRowModel:ae(),getFilteredRowModel:se(),getSortedRowModel:ee()}),K=r=>{var t;c({type:a,payload:r.target.value}),(t=h.getColumn("name"))==null||t.setFilterValue(r.target.value)},f=m(r=>r.employee),[O]=P();async function U(){await O({email:f.email,totalLeaves:f.totalLeaves,casualLeaves:f.casualLeaves})}return e.jsxs(e.Fragment,{children:[e.jsxs(Q,{className:"p-0",children:[e.jsxs("div",{className:"p-6 border-b border-border flex items-center lg:flex-nowrap gap-2 flex-wrap justify-between",children:[e.jsx("h5",{onClick:U,className:"text-lg font-semibold leading-none text-dark",children:"Leave Request Status"}),e.jsxs("div",{className:`flex items-center border rounded-md min-w-40 px-3 flex-1 max-w-80 ${l.isSearchFocussed?"border-primary ":"border-border"}`,children:[e.jsx(p,{icon:"si:search-line",width:20,height:20,className:"shrink-0 text-dark"}),e.jsx(_,{onBlur:I,onFocus:F,onChange:K,value:l.searchInput,type:"search",id:"email",name:"email",placeholder:"Search by name...",className:"max-w-80 h-9 bg-transparent dark:bg-transparent dark:text-white shadow-none border-none px-2"})]})]}),e.jsx("div",{className:"p-6 pt-0",children:e.jsx("div",{className:"rounded-md border border-border overflow-hidden",children:d?e.jsx(G,{}):e.jsxs(W,{className:"font-medium",children:[e.jsx(X,{children:h.getHeaderGroups().map(r=>e.jsx(w,{children:r.headers.map(t=>e.jsx(Z,{className:"first:px-4",children:t.isPlaceholder?null:D(t.column.columnDef.header,t.getContext())},t.id))},r.id))}),e.jsx(z,{children:h.getRowModel().rows.length?h.getRowModel().rows.map(r=>e.jsx(w,{children:r.getVisibleCells().map(t=>e.jsx(J,{className:"first:px-4",children:D(t.column.columnDef.cell,t.getContext())},t.id))},r.id)):null})]})})})]}),e.jsx(le,{}),e.jsx(ie,{})]})}function ye(){return e.jsx(e.Fragment,{children:e.jsx(ce,{})})}export{ye as default};
