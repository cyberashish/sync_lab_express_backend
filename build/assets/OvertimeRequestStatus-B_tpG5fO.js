import{j as e,_ as D,r as l,a8 as N,a as C,I}from"./index-snz9Drzv.js";import{C as M}from"./card-B1be1i6x.js";import{u as q,k as F,g as T,h as E,i as A,T as O,a as k,b as p,c as K,f as h,d as V,e as H}from"./TableSkeleton-BcOXqcpn.js";import{I as x}from"./iconify-C_4D0c8V.js";import{f as P}from"./format-SmSpYad1.js";const B=[{accessorKey:"employeeId",header:"Id",cell:({row:s})=>e.jsx("p",{className:"text-primary",children:s.getValue("employeeId")})},{accessorKey:"name",header:"Name"},{accessorKey:"designation",header:"Position"},{accessorKey:"description",header:"Description"},{accessorKey:"date",header:({column:s})=>e.jsxs("button",{onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),className:"flex cursor-pointer group hover:text-primary items-center gap-2",children:[e.jsx("span",{children:"Applied Date"}),e.jsx(x,{icon:"mi:sort",width:20,height:20,className:"text-muted group-hover:text-primary"})]}),cell:({row:s})=>e.jsx("p",{children:D(s.getValue("date"))}),sortingFn:(s,r)=>{const o=new Date(s.getValue("date")),c=new Date(r.getValue("date"));return o.getTime()-c.getTime()}},{accessorKey:"overtimeDates",header:()=>e.jsx("button",{className:"flex cursor-pointer group hover:text-primary items-center gap-2",children:e.jsx("span",{children:"Overtime Dates"})}),cell:({row:s})=>{const r=s.getValue("overtimeDates");return e.jsxs("p",{className:"text-sm",children:[" ",r.map(o=>P(new Date(o.date),"do MMM")).join(", ")]})}},{accessorKey:"overtimeDays",header:"Overtime Days"},{accessorKey:"requestStatus",header:"Status",cell:({row:s})=>{const r=s.getValue("requestStatus"),o=s.original.isRequestApproved;return r!=="pending"?o?e.jsx("span",{className:"py-0.5 px-2 text-xs bg-success/20 text-success rounded-full",children:"Approved"}):e.jsx("span",{className:"py-0.5 px-2 text-xs bg-red-500/20 text-red-500 rounded-full",children:"Rejected"}):e.jsx("span",{className:"py-0.5 px-2 text-xs bg-yellow-500/20 text-yellow-500 rounded-full",children:"Pending"})}}],Y={isSearchFocussed:!1,searchInput:""};function _(){const s="SEARCH_INPUT",r="SEARCH_INPUT_FOCUSSED",[o,c]=l.useState([]),g=(a,t)=>{switch(t.type){case s:return{...a,searchInput:t.payload};case r:return{...a,isSearchFocussed:t.payload};default:return a}},[u,d]=l.useReducer(g,Y),[m,f]=l.useState([]),[y,{isLoading:j}]=N(),i=C(a=>a.employee),b=()=>{d({type:r,payload:!0})},v=()=>{d({type:r,payload:!1})},R=l.useMemo(()=>[...m],[m]);l.useEffect(()=>{o&&f(o)},[o]);async function w(a){try{const t=await y({email:a});c(t.data.data.overtimes)}catch(t){console.log("Failed to fetch overtime requests!",t)}}l.useEffect(()=>{i&&w(i.email)},[i]);const n=q({data:R,columns:B,getCoreRowModel:E(),getFilteredRowModel:T(),getSortedRowModel:F()}),S=a=>{var t;d({type:s,payload:a.target.value}),(t=n.getColumn("name"))==null||t.setFilterValue(a.target.value)};return e.jsx(e.Fragment,{children:e.jsxs(M,{className:"p-0",children:[e.jsxs("div",{className:"p-6 border-b border-border flex items-center lg:flex-nowrap gap-2 flex-wrap justify-between",children:[e.jsx("h5",{className:"text-lg font-semibold leading-none text-dark",children:"Overtime Request Status"}),e.jsxs("div",{className:`flex items-center border rounded-md px-3 flex-1 max-w-80 ${u.isSearchFocussed?"border-primary ":"border-border"}`,children:[e.jsx(x,{icon:"si:search-line",width:20,height:20,className:"shrink-0 text-dark"}),e.jsx(I,{onBlur:v,onFocus:b,onChange:S,value:u.searchInput,type:"search",id:"email",name:"email",placeholder:"Search by name...",className:"max-w-80 h-9 bg-transparent dark:bg-transparent dark:text-white shadow-none border-none px-2"})]})]}),e.jsx("div",{className:"p-6 pt-0",children:e.jsx("div",{className:"rounded-md border border-border overflow-hidden",children:j?e.jsx(A,{}):e.jsxs(O,{className:"font-medium",children:[e.jsx(k,{children:n.getHeaderGroups().map(a=>e.jsx(p,{children:a.headers.map(t=>e.jsx(K,{className:"first:px-4",children:t.isPlaceholder?null:h(t.column.columnDef.header,t.getContext())},t.id))},a.id))}),e.jsx(V,{children:n.getRowModel().rows.length?n.getRowModel().rows.map(a=>e.jsx(p,{children:a.getVisibleCells().map(t=>e.jsx(H,{className:"first:px-4",children:h(t.column.columnDef.cell,t.getContext())},t.id))},a.id)):null})]})})})]})})}const J=()=>e.jsx(e.Fragment,{children:e.jsx(_,{})});export{J as default};
